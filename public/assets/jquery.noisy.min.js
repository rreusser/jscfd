(function(a){a.fn.noisy=function(b){var b=a.extend({},a.fn.noisy.defaults,b),d,e,f=!1;try{e="localStorage"in window&&window.localStorage!==null}catch(g){e=!1}window.JSON&&e&&(f=localStorage.getItem(window.JSON.stringify(b)));if(f)d=f;else{f=document.createElement("canvas");if(f.getContext){f.width=f.height=b.size;for(var h=f.getContext("2d"),i=h.createImageData(f.width,f.height),j=b.intensity*Math.pow(b.size,2),k=255*b.opacity;j--;){var l=~~(Math.random()*f.width),m=~~(Math.random()*f.height),l=(l+m*i.width)*4,m=j%255;i.data[l]=m,i.data[l+1]=b.monochrome?m:~~(Math.random()*255),i.data[l+2]=b.monochrome?m:~~(Math.random()*255),i.data[l+3]=~~(Math.random()*k)}h.putImageData(i,0,0),d=f.toDataURL("image/png");if(d.indexOf("data:image/png")!=0||a.browser.msie&&a.browser.version.substr(0,1)<9&&d.length>32768)d=b.fallback}else d=b.fallback;window.JSON&&e&&localStorage.setItem(window.JSON.stringify(b),d)}return this.each(function(){a(this).css("background-image","url('"+d+"'),"+a(this).css("background-image"))})},a.fn.noisy.defaults={intensity:.9,size:200,opacity:.08,fallback:"",monochrome:!1}})(jQuery);